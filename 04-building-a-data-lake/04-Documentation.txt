
โค้ดนี้ทำการดึงข้อมูลจากไฟล์ JSON ที่เก็บข้อมูลกิจกรรมใน GitHub และจัดเก็บข้อมูลลงในตารางและไฟล์ CSV ต่าง ๆ โดยใช้ PySpark โดยมีขั้นตอนดังนี้:

1.อ่านและโหลดข้อมูล JSON จากไฟล์.
2.สร้าง Temporary View เพื่อทำให้ข้อมูลสามารถเข้าถึงได้ง่ายขึ้น.
3.สร้างตารางจากข้อมูลที่โหลดมาและทำการแปลงข้อมูลต่าง ๆ.
4.เขียนข้อมูลลงในไฟล์ CSV และ Parquet เพื่อจัดเก็บข้อมูล.
5.จัดเก็บข้อมูลลงในตารางและไฟล์ CSV ต่าง ๆ โดยแยกแยะตามประเภทของกิจกรรม (Actors, Repos).